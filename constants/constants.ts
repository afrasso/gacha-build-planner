import { ArtifactTier, ArtifactType, OverallStatKey, StatKey } from "@/types";

export const ARTIFACT_LEVELS_PER_SUBSTAT_ROLL = 4;

// Source: https://genshin-impact.fandom.com/wiki/Artifact/Stats
export const ARTIFACT_MAX_LEVEL_BY_RARITY: Record<number, number> = {
  1: 4,
  2: 4,
  3: 12,
  4: 16,
  5: 20,
};

export const ARTIFACT_TIER_BY_NUMERIC_RATING: Record<number, ArtifactTier> = {
  0: ArtifactTier.F,
  1: ArtifactTier.D,
  2: ArtifactTier.C,
  3: ArtifactTier.B,
  4: ArtifactTier.A,
  5: ArtifactTier.S,
  6: ArtifactTier.SS,
  7: ArtifactTier.SSS,
  8: ArtifactTier.SSS_PLUS,
};

// Source: https://keqingmains.com/misc/artifacts/
// These odds assume the artifact source is a domain.
export const INITIAL_SUBSTAT_COUNT_ODDS_BY_RARITY: Record<number, Record<number, number>> = {
  1: { 0: 1 },
  2: { 0: 0.8, 1: 0.2 },
  3: { 1: 0.8, 2: 0.2 },
  4: { 2: 0.8, 3: 0.2 },
  5: { 3: 0.8, 4: 0.2 },
};

export const MAIN_STAT_MAX_VALUES_BY_RARITY: Record<number, Partial<Record<StatKey, number>>> = {
  1: {
    [StatKey.ATK_FLAT]: 21,
    [StatKey.ATK_PERCENT]: 7.9,
    [StatKey.CRIT_DMG]: 10.5,
    [StatKey.CRIT_RATE]: 5.3,
    [StatKey.DEF_PERCENT]: 9.9,
    [StatKey.DMG_BONUS_ANEMO]: 7.9,
    [StatKey.DMG_BONUS_CRYO]: 7.9,
    [StatKey.DMG_BONUS_DENDRO]: 7.9,
    [StatKey.DMG_BONUS_ELECTRO]: 7.9,
    [StatKey.DMG_BONUS_GEO]: 7.9,
    [StatKey.DMG_BONUS_HYDRO]: 7.9,
    [StatKey.DMG_BONUS_PHYSICAL]: 9.9,
    [StatKey.DMG_BONUS_PYRO]: 7.9,
    [StatKey.ELEMENTAL_MASTERY]: 31.6,
    [StatKey.ENERGY_RECHARGE]: 8.8,
    [StatKey.HEALING_BONUS]: 6.1,
    [StatKey.HP_FLAT]: 324,
    [StatKey.HP_PERCENT]: 7.9,
  },
  2: {
    [StatKey.ATK_FLAT]: 36,
    [StatKey.ATK_PERCENT]: 9,
    [StatKey.CRIT_DMG]: 11.9,
    [StatKey.CRIT_RATE]: 6.0,
    [StatKey.DEF_PERCENT]: 11.2,
    [StatKey.DMG_BONUS_ANEMO]: 9.0,
    [StatKey.DMG_BONUS_CRYO]: 9.0,
    [StatKey.DMG_BONUS_DENDRO]: 9.0,
    [StatKey.DMG_BONUS_ELECTRO]: 9.0,
    [StatKey.DMG_BONUS_GEO]: 9.0,
    [StatKey.DMG_BONUS_HYDRO]: 9.0,
    [StatKey.DMG_BONUS_PHYSICAL]: 11.2,
    [StatKey.DMG_BONUS_PYRO]: 9.0,
    [StatKey.ELEMENTAL_MASTERY]: 35.8,
    [StatKey.ENERGY_RECHARGE]: 9.9,
    [StatKey.HEALING_BONUS]: 6.9,
    [StatKey.HP_FLAT]: 551,
    [StatKey.HP_PERCENT]: 9.0,
  },
  3: {
    [StatKey.ATK_FLAT]: 123,
    [StatKey.ATK_PERCENT]: 23.1,
    [StatKey.CRIT_DMG]: 30.8,
    [StatKey.CRIT_RATE]: 15.4,
    [StatKey.DEF_PERCENT]: 28.8,
    [StatKey.DMG_BONUS_ANEMO]: 23.1,
    [StatKey.DMG_BONUS_CRYO]: 23.1,
    [StatKey.DMG_BONUS_DENDRO]: 23.1,
    [StatKey.DMG_BONUS_ELECTRO]: 23.1,
    [StatKey.DMG_BONUS_GEO]: 23.1,
    [StatKey.DMG_BONUS_HYDRO]: 23.1,
    [StatKey.DMG_BONUS_PHYSICAL]: 28.8,
    [StatKey.DMG_BONUS_PYRO]: 23.1,
    [StatKey.ELEMENTAL_MASTERY]: 92.3,
    [StatKey.ENERGY_RECHARGE]: 25.6,
    [StatKey.HEALING_BONUS]: 17.8,
    [StatKey.HP_FLAT]: 1893,
    [StatKey.HP_PERCENT]: 23.1,
  },
  4: {
    [StatKey.ATK_FLAT]: 232,
    [StatKey.ATK_PERCENT]: 34.8,
    [StatKey.CRIT_DMG]: 46.4,
    [StatKey.CRIT_RATE]: 23.2,
    [StatKey.DEF_PERCENT]: 43.5,
    [StatKey.DMG_BONUS_ANEMO]: 34.8,
    [StatKey.DMG_BONUS_CRYO]: 34.8,
    [StatKey.DMG_BONUS_DENDRO]: 34.8,
    [StatKey.DMG_BONUS_ELECTRO]: 34.8,
    [StatKey.DMG_BONUS_GEO]: 34.8,
    [StatKey.DMG_BONUS_HYDRO]: 34.8,
    [StatKey.DMG_BONUS_PHYSICAL]: 43.5,
    [StatKey.DMG_BONUS_PYRO]: 34.8,
    [StatKey.ELEMENTAL_MASTERY]: 92.3,
    [StatKey.ENERGY_RECHARGE]: 38.7,
    [StatKey.HEALING_BONUS]: 26.8,
    [StatKey.HP_FLAT]: 3571,
    [StatKey.HP_PERCENT]: 34.8,
  },
  5: {
    [StatKey.ATK_FLAT]: 311,
    [StatKey.ATK_PERCENT]: 46.6,
    [StatKey.CRIT_DMG]: 62.2,
    [StatKey.CRIT_RATE]: 31.1,
    [StatKey.DEF_PERCENT]: 58.3,
    [StatKey.DMG_BONUS_ANEMO]: 46.6,
    [StatKey.DMG_BONUS_CRYO]: 46.6,
    [StatKey.DMG_BONUS_DENDRO]: 46.6,
    [StatKey.DMG_BONUS_ELECTRO]: 46.6,
    [StatKey.DMG_BONUS_GEO]: 46.6,
    [StatKey.DMG_BONUS_HYDRO]: 46.6,
    [StatKey.DMG_BONUS_PHYSICAL]: 58.3,
    [StatKey.DMG_BONUS_PYRO]: 46.6,
    [StatKey.ELEMENTAL_MASTERY]: 187,
    [StatKey.ENERGY_RECHARGE]: 51.8,
    [StatKey.HEALING_BONUS]: 35.9,
    [StatKey.HP_FLAT]: 4780,
    [StatKey.HP_PERCENT]: 46.6,
  },
};

// Source: https://genshin-impact.fandom.com/wiki/Artifact/Distribution
export const MAIN_STAT_ODDS_BY_ARTIFACT_TYPE: Record<ArtifactType, Partial<Record<StatKey, number>>> = {
  [ArtifactType.CIRCLET]: {
    [StatKey.ATK_PERCENT]: 0.22,
    [StatKey.CRIT_DMG]: 0.1,
    [StatKey.CRIT_RATE]: 0.1,
    [StatKey.DEF_PERCENT]: 0.22,
    [StatKey.ELEMENTAL_MASTERY]: 0.04,
    [StatKey.HEALING_BONUS]: 0.1,
    [StatKey.HP_PERCENT]: 0.22,
  },
  [ArtifactType.FLOWER]: { [StatKey.HP_FLAT]: 1 },
  [ArtifactType.GOBLET]: {
    [StatKey.ATK_PERCENT]: 0.1925,
    [StatKey.DEF_PERCENT]: 0.19,
    [StatKey.DMG_BONUS_ANEMO]: 0.05,
    [StatKey.DMG_BONUS_CRYO]: 0.05,
    [StatKey.DMG_BONUS_DENDRO]: 0.05,
    [StatKey.DMG_BONUS_ELECTRO]: 0.05,
    [StatKey.DMG_BONUS_GEO]: 0.05,
    [StatKey.DMG_BONUS_HYDRO]: 0.05,
    [StatKey.DMG_BONUS_PHYSICAL]: 0.05,
    [StatKey.DMG_BONUS_PYRO]: 0.05,
    [StatKey.ELEMENTAL_MASTERY]: 0.025,
    [StatKey.HP_PERCENT]: 0.1925,
  },
  [ArtifactType.PLUME]: { [StatKey.ATK_FLAT]: 1 },
  [ArtifactType.SANDS]: {
    [StatKey.ATK_PERCENT]: 0.2666,
    [StatKey.DEF_PERCENT]: 0.2666,
    [StatKey.ELEMENTAL_MASTERY]: 0.1,
    [StatKey.ENERGY_RECHARGE]: 0.1,
    [StatKey.HP_PERCENT]: 0.2668,
  },
};

export const MAX_SUBSTATS = 4;

export const OVERALL_STATS_ORDER: OverallStatKey[] = [
  OverallStatKey.MAX_HP,
  OverallStatKey.ATK,
  OverallStatKey.DEF,
  OverallStatKey.ELEMENTAL_MASTERY,
  OverallStatKey.CRIT_RATE,
  OverallStatKey.CRIT_DMG,
  OverallStatKey.HEALING_BONUS,
  OverallStatKey.ENERGY_RECHARGE,
  OverallStatKey.DMG_BONUS_PYRO,
  OverallStatKey.DMG_BONUS_HYDRO,
  OverallStatKey.DMG_BONUS_DENDRO,
  OverallStatKey.DMG_BONUS_ELECTRO,
  OverallStatKey.DMG_BONUS_ANEMO,
  OverallStatKey.DMG_BONUS_CRYO,
  OverallStatKey.DMG_BONUS_GEO,
  OverallStatKey.DMG_BONUS_PHYSICAL,
];

// Source: https://genshin-impact.fandom.com/wiki/Artifact/Stats
export const SUB_STAT_ROLL_VALUES_BY_RARITY: Record<number, Partial<Record<StatKey, number[]>>> = {
  1: {
    [StatKey.ATK_FLAT]: [1.56, 1.95],
    [StatKey.ATK_PERCENT]: [1.17, 1.46],
    [StatKey.CRIT_DMG]: [1.55, 1.94],
    [StatKey.CRIT_RATE]: [0.78, 0.97],
    [StatKey.DEF_FLAT]: [1.85, 2.31],
    [StatKey.DEF_PERCENT]: [1.46, 1.82],
    [StatKey.ELEMENTAL_MASTERY]: [4.66, 5.83],
    [StatKey.ENERGY_RECHARGE]: [1.3, 1.62],
    [StatKey.HP_FLAT]: [23.9, 29.88],
    [StatKey.HP_PERCENT]: [1.17, 1.46],
  },
  2: {
    [StatKey.ATK_FLAT]: [3.27, 3.97, 4.67],
    [StatKey.ATK_PERCENT]: [1.63, 1.98, 2.33],
    [StatKey.CRIT_DMG]: [2.18, 2.64, 3.11],
    [StatKey.CRIT_RATE]: [1.09, 1.32, 1.55],
    [StatKey.DEF_FLAT]: [3.89, 4.72, 5.56],
    [StatKey.DEF_PERCENT]: [2.04, 2.48, 2.91],
    [StatKey.ELEMENTAL_MASTERY]: [6.53, 7.93, 9.33],
    [StatKey.ENERGY_RECHARGE]: [1.81, 2.2, 2.59],
    [StatKey.HP_FLAT]: [50.19, 60.95, 71.7],
    [StatKey.HP_PERCENT]: [1.63, 1.98, 2.33],
  },
  3: {
    [StatKey.ATK_FLAT]: [6.54, 7.47, 8.4, 9.34],
    [StatKey.ATK_PERCENT]: [2.45, 2.8, 3.15, 3.5],
    [StatKey.CRIT_DMG]: [3.26, 3.73, 4.2, 4.66],
    [StatKey.CRIT_RATE]: [1.63, 1.86, 2.1, 2.33],
    [StatKey.DEF_FLAT]: [7.78, 8.89, 10.0, 11.11],
    [StatKey.DEF_PERCENT]: [3.06, 3.5, 3.93, 4.37],
    [StatKey.ELEMENTAL_MASTERY]: [9.79, 11.19, 12.59, 13.99],
    [StatKey.ENERGY_RECHARGE]: [2.72, 3.11, 3.5, 3.89],
    [StatKey.HP_FLAT]: [100.38, 114.72, 129.06, 143.4],
    [StatKey.HP_PERCENT]: [2.45, 2.8, 3.15, 3.5],
  },
  4: {
    [StatKey.ATK_FLAT]: [10.89, 12.45, 14.0, 15.56],
    [StatKey.ATK_PERCENT]: [3.26, 3.73, 4.2, 4.66],
    [StatKey.CRIT_DMG]: [4.35, 4.97, 5.6, 6.22],
    [StatKey.CRIT_RATE]: [2.18, 2.49, 2.8, 3.11],
    [StatKey.DEF_FLAT]: [12.96, 14.82, 16.67, 18.52],
    [StatKey.DEF_PERCENT]: [4.08, 4.66, 5.25, 5.83],
    [StatKey.ELEMENTAL_MASTERY]: [13.06, 14.92, 16.79, 18.65],
    [StatKey.ENERGY_RECHARGE]: [3.63, 4.14, 4.66, 5.18],
    [StatKey.HP_FLAT]: [167.3, 191.2, 215.1, 239.0],
    [StatKey.HP_PERCENT]: [3.26, 3.73, 4.2, 4.66],
  },
  5: {
    [StatKey.ATK_FLAT]: [13.62, 15.56, 17.51, 19.45],
    [StatKey.ATK_PERCENT]: [4.08, 4.66, 5.25, 5.83],
    [StatKey.CRIT_DMG]: [5.44, 6.22, 6.99, 7.77],
    [StatKey.CRIT_RATE]: [2.72, 3.11, 3.5, 3.89],
    [StatKey.DEF_FLAT]: [16.2, 18.52, 20.83, 23.15],
    [StatKey.DEF_PERCENT]: [5.1, 5.83, 6.56, 7.29],
    [StatKey.ELEMENTAL_MASTERY]: [16.32, 18.65, 20.98, 23.31],
    [StatKey.ENERGY_RECHARGE]: [4.53, 5.18, 5.83, 6.48],
    [StatKey.HP_FLAT]: [209.13, 239.0, 268.88, 298.75],
    [StatKey.HP_PERCENT]: [4.08, 4.66, 5.25, 5.83],
  },
};

export const SUB_STAT_WEIGHTS: Partial<Record<StatKey, number>> = {
  [StatKey.ATK_FLAT]: 6,
  [StatKey.ATK_PERCENT]: 4,
  [StatKey.CRIT_DMG]: 3,
  [StatKey.CRIT_RATE]: 3,
  [StatKey.DEF_FLAT]: 6,
  [StatKey.DEF_PERCENT]: 4,
  [StatKey.ELEMENTAL_MASTERY]: 4,
  [StatKey.ENERGY_RECHARGE]: 4,
  [StatKey.HP_FLAT]: 6,
  [StatKey.HP_PERCENT]: 4,
};
